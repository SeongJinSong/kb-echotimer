# KB EchoTimer

ì¹´ì¹´ì˜¤ë±…í¬ ê³¼ì œë¥¼ ìœ„í•œ ì‹¤ì‹œê°„ íƒ€ì´ë¨¸ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.  
Spring Boot 3 + WebFlux + Kafka + Redis + MongoDBë¥¼ ì‚¬ìš©í•œ ë¶„ì‚° í™˜ê²½ì—ì„œì˜ WebSocket ê¸°ë°˜ íƒ€ì´ë¨¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SPA Client    â”‚    â”‚   SPA Client    â”‚    â”‚   SPA Client    â”‚
â”‚   (WebSocket)   â”‚    â”‚   (WebSocket)   â”‚    â”‚   (WebSocket)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                             â”‚                             â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚Server 1â”‚                   â”‚Server 2â”‚                   â”‚Server 3â”‚
â”‚(8090)  â”‚                   â”‚(8091)  â”‚                   â”‚(8092)  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚                            â”‚                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚               â”‚               â”‚
            â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
            â”‚  Kafka  â”‚     â”‚  Redis  â”‚     â”‚MongoDB â”‚
            â”‚ (9092)  â”‚     â”‚ (6379)  â”‚     â”‚(27017) â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ ê¸°ìˆ  ìŠ¤íƒ

### Backend
- **Spring Boot 3.2.0** - ë©”ì¸ í”„ë ˆì„ì›Œí¬
- **Java 21** - í”„ë¡œê·¸ë˜ë° ì–¸ì–´
- **Spring WebFlux** - ë¦¬ì•¡í‹°ë¸Œ ì›¹ í”„ë ˆì„ì›Œí¬
- **Spring WebSocket (STOMP)** - ì‹¤ì‹œê°„ í†µì‹ 
- **Apache Kafka** - ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë° (KRaft ëª¨ë“œ)
- **Redis** - ì—°ê²° ìƒíƒœ ê´€ë¦¬ ë° ìºì‹±
- **MongoDB** - íƒ€ì„ìŠ¤íƒ¬í”„ ë°ì´í„° ì €ì¥

### Infrastructure
- **Docker Compose** - ë¡œì»¬ ê°œë°œ í™˜ê²½
- **Kafka UI** - Kafka ëª¨ë‹ˆí„°ë§
- **Spring Boot Actuator** - í—¬ìŠ¤ì²´í¬ ë° ë©”íŠ¸ë¦­

## ğŸ“‹ ì£¼ìš” ê¸°ëŠ¥

### 1. ë¶„ì‚° WebSocket ì—°ê²° ê´€ë¦¬
- Redisë¥¼ í†µí•œ ì‚¬ìš©ì-ì„œë²„ ë§¤í•‘ ê´€ë¦¬
- ë‹¤ì¤‘ ì„œë²„ í™˜ê²½ì—ì„œì˜ íš¨ìœ¨ì ì¸ ë©”ì‹œì§€ ë¼ìš°íŒ…

### 2. ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜
- Kafkaë¥¼ í†µí•œ ì´ë²¤íŠ¸ ì „íŒŒ
- ì„œë²„ë³„ í•„í„°ë§ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ ë¹„ìš© ìµœì í™”

### 3. íƒ€ì´ë¨¸ ê¸°ëŠ¥
- í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ íƒ€ì´ë¨¸ (ì„œë²„ ë¶€í•˜ ìµœì†Œí™”)
- ì„œë²„ ì‹œê°„ ë™ê¸°í™”
- íƒ€ì„ìŠ¤íƒ¬í”„ ì €ì¥ ë° ê´€ë¦¬

## ğŸ› ï¸ ì„¤ì¹˜ ë° ì‹¤í–‰

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­
- Java 21
- Docker & Docker Compose
- Git

### 1. í”„ë¡œì íŠ¸ í´ë¡ 
```bash
git clone <repository-url>
cd kb-echotimer
```

### 2. ì¸í”„ë¼ ì„œë¹„ìŠ¤ ì‹œì‘
```bash
docker-compose up -d
```

### 3. ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰
```bash
./gradlew bootRun
```

## ğŸŒ ì„œë¹„ìŠ¤ ì ‘ì† ì •ë³´

| ì„œë¹„ìŠ¤ | URL | ì„¤ëª… |
|--------|-----|------|
| Spring Boot | http://localhost:8090 | ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ |
| Health Check | http://localhost:8090/actuator/health | í—¬ìŠ¤ì²´í¬ |
| Kafka UI | http://localhost:8081 | Kafka ëª¨ë‹ˆí„°ë§ |
| MongoDB | localhost:27017 | ë°ì´í„°ë² ì´ìŠ¤ |
| Redis | localhost:6379 | ìºì‹œ ë° ì„¸ì…˜ ê´€ë¦¬ |
| Kafka | localhost:9092 | ë©”ì‹œì§€ ë¸Œë¡œì»¤ |

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
src/main/java/com/kb/timer/
â”œâ”€â”€ TimerApplication.java          # ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜
â”œâ”€â”€ config/                        # ì„¤ì • í´ë˜ìŠ¤ë“¤
â”‚   â”œâ”€â”€ KafkaConfig.java          # Kafka ì„¤ì •
â”‚   â”œâ”€â”€ RedisConfig.java          # Redis ì„¤ì •
â”‚   â””â”€â”€ WebSocketConfig.java      # WebSocket ì„¤ì •
â”œâ”€â”€ model/                         # ë°ì´í„° ëª¨ë¸
â”‚   â”œâ”€â”€ dto/                      # DTO í´ë˜ìŠ¤ë“¤
â”‚   â”œâ”€â”€ entity/                   # ì—”í‹°í‹° í´ë˜ìŠ¤ë“¤
â”‚   â””â”€â”€ event/                    # ì´ë²¤íŠ¸ í´ë˜ìŠ¤ë“¤
â””â”€â”€ service/                       # ì„œë¹„ìŠ¤ ë¡œì§
    â””â”€â”€ RedisConnectionManager.java
```

## ğŸ”§ ì„¤ì •

### application.yml ì£¼ìš” ì„¤ì •
```yaml
server:
  port: 8090

spring:
  data:
    mongodb:
      uri: mongodb://localhost:27017/timer_service
    redis:
      host: localhost
      port: 6379
  kafka:
    bootstrap-servers: localhost:9092
```

## ğŸ“Š ëª¨ë‹ˆí„°ë§

### Health Check
```bash
curl http://localhost:8090/actuator/health
```

### Kafka Topics í™•ì¸
- Kafka UI: http://localhost:8081
- ë˜ëŠ” CLI: `docker exec -it kb-timer-kafka kafka-topics --bootstrap-server localhost:9092 --list`

## ğŸ³ Docker ì„œë¹„ìŠ¤

### ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
```bash
docker-compose ps
```

### ë¡œê·¸ í™•ì¸
```bash
# ì „ì²´ ë¡œê·¸
docker-compose logs

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸
docker-compose logs kafka
docker-compose logs mongodb
docker-compose logs redis
```

### ì„œë¹„ìŠ¤ ì¬ì‹œì‘
```bash
# ì „ì²´ ì¬ì‹œì‘
docker-compose restart

# íŠ¹ì • ì„œë¹„ìŠ¤ ì¬ì‹œì‘
docker-compose restart kafka
```

## ğŸ” ê°œë°œ ê°€ì´ë“œ

### ìƒˆë¡œìš´ ì´ë²¤íŠ¸ ì¶”ê°€
1. `src/main/java/com/kb/timer/model/event/` ì— ì´ë²¤íŠ¸ í´ë˜ìŠ¤ ìƒì„±
2. `TimerEvent` ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
3. Kafka Producer/Consumerì—ì„œ ì²˜ë¦¬ ë¡œì§ ì¶”ê°€

### ìƒˆë¡œìš´ ì—”í‹°í‹° ì¶”ê°€
1. `src/main/java/com/kb/timer/model/entity/` ì— ì—”í‹°í‹° í´ë˜ìŠ¤ ìƒì„±
2. MongoDB ì»¬ë ‰ì…˜ ë§¤í•‘ ì„¤ì •
3. Repository ì¸í„°í˜ì´ìŠ¤ ìƒì„± (í•„ìš”ì‹œ)

## ğŸš¨ ë¬¸ì œ í•´ê²°

### Kafka ì—°ê²° ì‹¤íŒ¨
```bash
# Kafka ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
docker-compose restart kafka

# Kafka ë¡œê·¸ í™•ì¸
docker-compose logs kafka
```

### MongoDB ì—°ê²° ì‹¤íŒ¨
```bash
# MongoDB ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker-compose ps mongodb

# MongoDB ë¡œê·¸ í™•ì¸
docker-compose logs mongodb
```

### Redis ì—°ê²° ì‹¤íŒ¨
```bash
# Redis ì—°ê²° í…ŒìŠ¤íŠ¸
docker exec -it kb-timer-redis redis-cli ping

# Redis ë¡œê·¸ í™•ì¸
docker-compose logs redis
```

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

- [ ] í•µì‹¬ ì„œë¹„ìŠ¤ ë¡œì§ êµ¬í˜„
- [ ] WebSocket ë©”ì‹œì§€ í•¸ë“¤ëŸ¬ êµ¬í˜„
- [ ] Kafka Consumer/Producer ë¡œì§ êµ¬í˜„
- [ ] í”„ë¡ íŠ¸ì—”ë“œ SPA ê°œë°œ
- [ ] í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±

## ğŸ“„ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” ì¹´ì¹´ì˜¤ë±…í¬ ê³¼ì œìš©ìœ¼ë¡œ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.
